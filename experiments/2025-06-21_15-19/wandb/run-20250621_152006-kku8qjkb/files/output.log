[2025-06-21 15:20:39,161][__main__][INFO] - Initializing trainer...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
[2025-06-21 15:20:39,186][__main__][INFO] - Starting training...
[2025-06-21 15:20:39,824][src.data.dataloader][INFO] - Downloading MNIST dataset...
[2025-06-21 15:20:39,842][src.data.dataloader][INFO] - MNIST dataset downloaded to ./data
[2025-06-21 15:20:39,886][src.data.dataloader][INFO] - Train dataset: 54000 samples, dtype=torch.float32
[2025-06-21 15:20:39,887][src.data.dataloader][INFO] - Val dataset: 6000 samples, dtype=torch.float32
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name        | Type               | Params | Mode
-----------------------------------------------------------
0 | conv_layers | Sequential         | 18.8 K | train
1 | classifier  | Sequential         | 402 K  | train
2 | train_acc   | MulticlassAccuracy | 0      | train
3 | val_acc     | MulticlassAccuracy | 0      | train
4 | test_acc    | MulticlassAccuracy | 0      | train
5 | train_f1    | MulticlassF1Score  | 0      | train
6 | val_f1      | MulticlassF1Score  | 0      | train
7 | test_f1     | MulticlassF1Score  | 0      | train
-----------------------------------------------------------
421 K     Trainable params
0         Non-trainable params
421 K     Total params
1.687     Total estimated model params size (MB)
19        Modules in train mode
0         Modules in eval mode
Epoch 12: 100%|█████████████████████| 843/843 [00:05<00:00, 156.68it/s, v_num=qjkb, train_loss_step=0.00155, train_acc_step=1.000, val_loss=0.0375, val_acc=0.990, train_loss_epoch=0.0181, train_acc_epoch=0.995]
[2025-06-21 15:22:38,680][__main__][INFO] - Testing model...                                                                                                                                                      
Metric val_loss improved. New best score: 0.078
Epoch 0, global step 843: 'val_loss' reached 0.07753 (best 0.07753), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=00-val_loss=0.08.ckpt' as top 3
Metric val_loss improved by 0.016 >= min_delta = 0.001. New best score: 0.061
Epoch 1, global step 1686: 'val_loss' reached 0.06147 (best 0.06147), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=01-val_loss=0.06.ckpt' as top 3
Metric val_loss improved by 0.011 >= min_delta = 0.001. New best score: 0.050
Epoch 2, global step 2529: 'val_loss' reached 0.05006 (best 0.05006), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=02-val_loss=0.05.ckpt' as top 3
Epoch 3, global step 3372: 'val_loss' reached 0.05326 (best 0.05006), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=03-val_loss=0.05.ckpt' as top 3
Metric val_loss improved by 0.004 >= min_delta = 0.001. New best score: 0.046
Epoch 4, global step 4215: 'val_loss' reached 0.04562 (best 0.04562), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=04-val_loss=0.05.ckpt' as top 3
Metric val_loss improved by 0.001 >= min_delta = 0.001. New best score: 0.044
Epoch 5, global step 5058: 'val_loss' reached 0.04428 (best 0.04428), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=05-val_loss=0.04.ckpt' as top 3
Epoch 6, global step 5901: 'val_loss' was not in top 3
Metric val_loss improved by 0.006 >= min_delta = 0.001. New best score: 0.038
Epoch 7, global step 6744: 'val_loss' reached 0.03791 (best 0.03791), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=07-val_loss=0.04.ckpt' as top 3
Epoch 8, global step 7587: 'val_loss' reached 0.03813 (best 0.03791), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=08-val_loss=0.04.ckpt' as top 3
Epoch 9, global step 8430: 'val_loss' reached 0.03759 (best 0.03759), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=09-val_loss=0.04.ckpt' as top 3
Epoch 10, global step 9273: 'val_loss' was not in top 3
Epoch 11, global step 10116: 'val_loss' reached 0.03716 (best 0.03716), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=11-val_loss=0.04.ckpt' as top 3
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.038. Signaling Trainer to stop.
Epoch 12, global step 10959: 'val_loss' reached 0.03755 (best 0.03716), saving model to '/home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=12-val_loss=0.04.ckpt' as top 3
[2025-06-21 15:22:38,680][src.data.dataloader][INFO] - Downloading MNIST dataset...
[2025-06-21 15:22:38,698][src.data.dataloader][INFO] - MNIST dataset downloaded to ./data
[2025-06-21 15:22:38,701][src.data.dataloader][INFO] - Test dataset: 10000 samples, dtype=torch.float32
Restoring states from the checkpoint path at /home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=11-val_loss=0.04.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at /home/james/ml_projects/images_ml_testbed/experiments/2025-06-21_15-19/checkpoints/best-epoch=11-val_loss=0.04.ckpt
Testing DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:00<00:00, 248.82it/s]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        test_acc            0.9936000108718872
         test_f1            0.9929084777832031
        test_loss           0.0213191956281662
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
[2025-06-21 15:22:39,423][__main__][INFO] - Training completed!
[2025-06-21 15:22:39,424][__main__][INFO] - Best validation loss: 0.0372
[2025-06-21 15:22:39,424][__main__][INFO] - Test loss: 0.0213
[2025-06-21 15:22:39,424][__main__][INFO] - Test accuracy: 0.9936
[2025-06-21 15:22:39,424][__main__][INFO] - Test F1-score: 0.9929
[2025-06-21 15:22:39,427][__main__][INFO] - Model saved to experiments/2025-06-21_15-19/final_model.pt
